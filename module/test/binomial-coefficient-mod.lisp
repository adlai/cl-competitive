(eval-when (:compile-toplevel :load-toplevel :execute)
  (load "test-util")
  (load "../binomial-coefficient-mod.lisp"))

(use-package :test-util)

(with-test (:name binom)
  (assert (= 0 (binom -1 1)))
  (assert (= 0 (binom 1 -2)))
  (assert (= 0 (binom 1 3)))
  (assert (= 1 (binom 0 0)))
  (assert (= 10 (binom 5 2)))
  (assert (= 962556519 (binom 1000 400))))

(with-test (:name catalan)
  (assert (= 1 (catalan 0)))
  (assert (= 1 (catalan 1)))
  (assert (= 429 (catalan 7)))
  (assert (= (mod 6564120420 +binom-mod+)
             (catalan 20))))

(with-test (:name stirling2)
  (let ((mat #2a((1 0 0 0 0 0 0 0)
                 (0 1 0 0 0 0 0 0)
                 (0 1 1 0 0 0 0 0)
                 (0 1 3 1 0 0 0 0)
                 (0 1 7 6 1 0 0 0)
                 (0 1 15 25 10 1 0 0)
                 (0 1 31 90 65 15 1 0))))
    (dotimes (n 7)
      (dotimes (k 8)
        (assert (= (aref mat n k) (stirling2 n k)))))
    (assert (= (stirling2 15 6)
               (mod 420693273 +binom-mod+)))))
